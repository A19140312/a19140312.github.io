var _typeof5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof4="function"==typeof Symbol&&"symbol"==_typeof5(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof5(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof5(e)},_typeof3="function"==typeof Symbol&&"symbol"==_typeof4(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof4(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof4(e)},_typeof2="function"==typeof Symbol&&"symbol"==_typeof3(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof3(e)},_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)};!function(e,n){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=n(e,!0):"function"==typeof define&&define.amd?define(function(){return n(e,!0)}):n(e)}("undefined"!=typeof window?window:void 0,function(b,e){"use strict";var g=b.document,y=g.documentElement,m=g.body,n="3.3.0",s=function e(n,t){return new e.fn.init(n,t)};s.version=n,s.fn=s.prototype={version:n,constructor:s,context:m,condition:y,routine:["initCond","renderElem","renderJiya","renderHanging","correctBiaodian","renderHWS","substCombLigaWithPUA"],init:function(){return arguments[0]&&(this.context=arguments[0]),arguments[1]&&(this.condition=arguments[1]),this},setRoutine:function(e){return Array.isArray(e)&&(this.routine=e),this},render:function(e){var n=this;return(e=Array.isArray(e)?e:this.routine).forEach(function(e){"string"==typeof e&&"function"==typeof n[e]?n[e]():Array.isArray(e)&&"function"==typeof n[e[0]]&&n[e.shift()].apply(n,e)}),this}},s.fn.init.prototype=s.fn,s.init=function(){return s.init=s().render()};var t,i,r,o,a,c,d,u,l,h,p,f,v,x,E,w,C,N,S,T,L,k,z,I,M,R,j,A,H,P={punct:{base:"[…,.;:!?‽_]",sing:"[‐-—…]",middle:"[\\/~\\-&‐-—_]",open:"['\"‘“\\(\\[¡¿⸘«‹‚“„]",close:"['\"”’\\)\\]»›‛”‟]",end:"['\"”’\\)\\]»›‛”‟‼‽⁇-⁉,.;:!?]"},biaodian:{base:"[︰．、，。：；？！ー]",liga:"[—…⋯]",middle:"[·＼／－゠＆・＿]",open:"[「『《〈（〔［｛【〖]",close:"[」』》〉）〕］｝】〗]",end:"[」』》〉）〕］｝】〗︰．、，。：；？！ー]"},hanzi:{base:"[一-鿿㐀-䶵㇀-㇣〇﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud800-\udbff][\udc00-\udfff]",desc:"[⿰-⿺]",radical:"[⼀-⿕⺀-⻳]"},latin:{base:"[A-Za-z0-9À-ÿĀ-ſƀ-ɏⱠ-Ɀ꜠-ꟿḀ-ỿ]",combine:"[̀-́᷀-᷿]"},ellinika:{base:"[0-9Ͱ-Ͽἀ-῿]",combine:"[̀-᷀ͅ-᷿]"},kirillica:{base:"[0-9Ѐ-҂Ҋ-ӿԀ-ԯꙀ-ꙮ꙾-ꚗ]",combine:"[҃-҉ⷠ-ⷿ꙯-꙽ꚟ]"},kana:{base:"[アイウエオ-ヺあいうえお-ゔゟヿ]|\ud82c[\udc00-\udc01]",small:"[ぁぃぅぇぉァィゥェォっゃゅょゎゕゖッャュョヮヵヶㇰ-ㇿ]",combine:"[゙-゜]",half:"[ｦ-ﾟ]",mark:"[゠ゝゞ・-ヾ]"},eonmun:{base:"[가-힣]",letter:"[ᄀ-ᇿㅏ-ㅣㄱ-ㆎꥠ-ꥼힰ-ퟻ]",half:"[ﾡ-ￜ]"},zhuyin:{base:"[ㄅ-ㄭㆠ-ㆺ]",initial:"[ㄅ-ㄙㄪ-ㄬㆠ-ㆣ]",medial:"[ㄧ-ㄩ]",final:"[ㄚ-ㄩㄭㆤ-ㆳㆸ-ㆺ]",tone:"[˙ˊ˅ˇˋ˪˫]",checked:"[ㆴ-ㆷ][̍͘]?"}},O=(t="[\\x20\\t\\r\\n\\f]",i=P.punct.open,P.punct.close,r=P.punct.end,o=P.punct.middle,a=P.punct.sing,c=i+"|"+r+"|"+o,d=P.biaodian.open,u=P.biaodian.close,l=P.biaodian.end,h=P.biaodian.middle,p=P.biaodian.liga+"{2}",f=d+"|"+l+"|"+h,v=P.kana.base+P.kana.combine+"?",x=P.kana.small+P.kana.combine+"?",E=P.kana.half,w=P.eonmun.base+"|"+P.eonmun.letter,C=P.eonmun.half,N=P.hanzi.base+"|"+P.hanzi.desc+"|"+P.hanzi.radical+"|"+v,S=P.ellinika.combine,T=P.latin.base+S+"*",L=P.ellinika.base+S+"*",k=P.kirillica.combine,M=N+"|(?:"+(I=T+"|"+L+"|"+(z=P.kirillica.base+k+"*"))+"|['’])+",R=P.zhuyin.initial,j=P.zhuyin.medial,A=P.zhuyin.final,H=P.zhuyin.tone+"|"+P.zhuyin.checked,{char:{punct:{all:new RegExp("("+c+")","g"),open:new RegExp("("+i+")","g"),end:new RegExp("("+r+")","g"),sing:new RegExp("("+a+")","g")},biaodian:{all:new RegExp("("+f+")","g"),open:new RegExp("("+d+")","g"),close:new RegExp("("+u+")","g"),end:new RegExp("("+l+")","g"),liga:new RegExp("("+p+")","g")},hanzi:new RegExp("("+N+")","g"),latin:new RegExp("("+T+")","ig"),ellinika:new RegExp("("+L+")","ig"),kirillica:new RegExp("("+z+")","ig"),kana:new RegExp("("+v+"|"+x+"|"+E+")","g"),eonmun:new RegExp("("+w+"|"+C+")","g")},group:{biaodian:[new RegExp("(("+f+"){2,})","g"),new RegExp("("+p+d+")","g")],punct:null,hanzi:new RegExp("("+N+")+","g"),western:new RegExp("("+T+"|"+L+"|"+z+"|"+c+")+","ig"),kana:new RegExp("("+v+"|"+x+"|"+E+")+","g"),eonmun:new RegExp("("+w+"|"+C+"|"+c+")+","g")},jinze:{hanging:new RegExp(t+"*([、，。．])(?!"+l+")","ig"),touwei:new RegExp("("+d+"+)("+M+")("+l+"+)","ig"),tou:new RegExp("("+d+"+)("+M+")","ig"),wei:new RegExp("("+M+")("+l+"+)","ig"),middle:new RegExp("("+M+")("+h+")("+M+")","ig")},zhuyin:{form:new RegExp("^˙?("+R+")?("+j+")?("+A+")?("+H+")?$"),diao:new RegExp("("+H+")","g")},hws:{base:[new RegExp("("+N+")("+I+"|"+i+")","ig"),new RegExp("("+I+"|"+r+")("+N+")","ig")],strict:[new RegExp("("+N+")"+t+"?("+I+"|"+i+")","ig"),new RegExp("("+I+"|"+r+")"+t+"?("+N+")","ig")]},"display-as":{"ja-font-for-hant":["查 査","啟 啓","鄉 鄕","值 値","污 汚"],"comb-liga-pua":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"],["ㆴ[̍͘]","󳆴"],["ㆵ[̍͘]","󳆵"],["ㆶ[̍͘]","󳆶"],["ㆷ[̍͘]","󳆷"]],"comb-liga-vowel":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"]],"comb-liga-zhuyin":[["ㆴ[̍͘]","󳆴"],["ㆵ[̍͘]","󳆵"],["ㆶ[̍͘]","󳆶"],["ㆷ[̍͘]","󳆷"]]},"inaccurate-char":[["[•‧]","·"],["⋯⋯","……"],["──","——"],["‵","‘"],["′","’"],["‶","“"],["″","”"]]});s.UNICODE=P,s.TYPESET=O,s.UNICODE.cjk=s.UNICODE.hanzi,s.UNICODE.greek=s.UNICODE.ellinika,s.UNICODE.cyrillic=s.UNICODE.kirillica,s.UNICODE.hangul=s.UNICODE.eonmun,s.UNICODE.zhuyin.ruyun=s.UNICODE.zhuyin.checked,s.TYPESET.char.cjk=s.TYPESET.char.hanzi,s.TYPESET.char.greek=s.TYPESET.char.ellinika,s.TYPESET.char.cyrillic=s.TYPESET.char.kirillica,s.TYPESET.char.hangul=s.TYPESET.char.eonmun,s.TYPESET.group.hangul=s.TYPESET.group.eonmun,s.TYPESET.group.cjk=s.TYPESET.group.hanzi;var _,B={id:function(e,n){return(n||g).getElementById(e)},tag:function(e,n){return this.makeArray((n||g).getElementsByTagName(e))},qs:function(e,n){return(n||g).querySelector(e)},qsa:function(e,n){return this.makeArray((n||g).querySelectorAll(e))},parent:function(e,n){return n?function(){if("function"==typeof B.matches){for(;!B.matches(e,n);){if(!e||e===g.documentElement){e=void 0;break}e=e.parentNode}return e}}():e?e.parentNode:void 0},create:function(e,n){var t="!"===e?g.createDocumentFragment():""===e?g.createTextNode(n||""):g.createElement(e);try{n&&(t.className=n)}catch(e){}return t},clone:function(e,n){return e.cloneNode("boolean"!=typeof n||n)},remove:function(e){return e.parentNode.removeChild(e)},setAttr:function(e,n){if("object"===(void 0===n?"undefined":_typeof(n))){var t=n.length;if("object"===_typeof(n[0])&&"name"in n[0])for(var i=0;i<t;i++)void 0!==n[i].value&&e.setAttribute(n[i].name,n[i].value);else for(var r in n)n.hasOwnProperty(r)&&void 0!==n[r]&&e.setAttribute(r,n[r]);return e}},isElmt:function(e){return e&&e.nodeType===Node.ELEMENT_NODE},isIgnorable:function(e){return!!e&&("WBR"===e.nodeName||e.nodeType===Node.COMMENT_NODE)},makeArray:function(e){return Array.prototype.slice.call(e)},extend:function(e,n){if(("object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e)&&"object"===(void 0===n?"undefined":_typeof(n)))for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}},D=function(i){var t=i.NON_INLINE_PROSE,r=i.PRESETS.prose.filterElements,o=(b||{}).document||void 0;function a(e,n,t){var i=Element.prototype,r=i.matches||i.mozMatchesSelector||i.msMatchesSelector||i.webkitMatchesSelector;return e instanceof Element?r.call(e,n):!(!t||!/^[39]$/.test(e.nodeType))}if(void 0===o)throw new Error("Fibre requires a DOM-supported environment.");var e=function e(n,t){return new e.fn.init(n,t)};return e.version="0.2.1",e.matches=a,(e.fn=e.prototype={constructor:e,version:"0.2.1",finder:[],context:void 0,portionMode:"retain",selector:{},preset:"prose",init:function(e,n){if(n&&(this.preset=null),this.selector={context:null,filter:[],avoid:[],boundary:[]},!e)throw new Error("A context is required for Fibre to initialise.");return e instanceof Node?e instanceof Document?this.context=e.body||e:this.context=e:"string"==typeof e&&(this.context=o.querySelector(e),this.selector.context=e),this},filterFn:function(e){var n=this.selector.filter.join(", ")||"*",t=this.selector.avoid.join(", ")||null,i=a(e,n,!0)&&!a(e,t);return"prose"===this.preset?r(e)&&i:i},boundaryFn:function(e){var n=a(e,this.selector.boundary.join(", ")||null);return"prose"===this.preset&&t(e)||n},filter:function(e){return"string"==typeof e&&this.selector.filter.push(e),this},endFilter:function(e){return e?this.selector.filter=[]:this.selector.filter.pop(),this},avoid:function(e){return"string"==typeof e&&this.selector.avoid.push(e),this},endAvoid:function(e){return e?this.selector.avoid=[]:this.selector.avoid.pop(),this},addBoundary:function(e){return"string"==typeof e&&this.selector.boundary.push(e),this},removeBoundary:function(){return this.selector.boundary=[],this},setMode:function(e){return this.portionMode="first"===e?"first":"retain",this},replace:function(e,n){var t=this;return t.finder.push(i(t.context,{find:e,replace:n,filterElements:function(e){return t.filterFn(e)},forceContext:function(e){return t.boundaryFn(e)},portionMode:t.portionMode})),t},wrap:function(e,n){var t=this;return t.finder.push(i(t.context,{find:e,wrap:n,filterElements:function(e){return t.filterFn(e)},forceContext:function(e){return t.boundaryFn(e)},portionMode:t.portionMode})),t},revert:function(e){var n=this.finder.length;if(e=Number(e)||(0===e?Number(0):"all"===e?n:1),void 0===n||0===n)return this;n<e&&(e=n);for(var t=e;0<t;t--)this.finder.pop().revert();return this}}).filterOut=e.fn.avoid,e.fn.init.prototype=e.fn,e}(function(){var r="retain",y=g,o={}.hasOwnProperty;function s(){return function(e,n,t,i,r){if(n&&!n.nodeType&&arguments.length<=2)return!1;var o,a="function"==typeof t;a&&(o=t,t=function(e,n){return o(e.text,n.startIndex)});var c=d(n,{find:e,wrap:a?null:t,replace:a?t:"$"+(i||"&"),prepMatch:function(e,n){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(0<i){var t=e[i];e.index+=e[0].indexOf(t),e[0]=t}return e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=n,e},filterElements:r});return s.revert=function(){return c.revert()},!0}.apply(null,arguments)||d.apply(null,arguments)}function d(e,n){return new t(e,n)}function t(e,n){var t=n.preset&&s.PRESETS[n.preset];if(n.portionMode=n.portionMode||r,t)for(var i in t)o.call(t,i)&&!o.call(n,i)&&(n[i]=t[i]);this.node=e,this.options=n,this.prepMatch=n.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}return s.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},s.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},s.PRESETS={prose:{forceContext:s.NON_INLINE_PROSE=function(e){return o.call(s.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())},filterElements:function(e){return!o.call(s.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}},(s.Finder=t).prototype={search:function(){var o,a=0,c=0,s=this.options.find,e=this.getAggregateText(),d=[],u=this;return s="string"==typeof s?RegExp(String(s).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"),"g"):s,function e(n){for(var t=0,i=n.length;t<i;++t){var r=n[t];if("string"==typeof r){if(s.global)for(;o=s.exec(r);)d.push(u.prepMatch(o,a++,c));else(o=r.match(s))&&d.push(u.prepMatch(o,0,c));c+=r.length}else e(r)}}(e),d},prepMatch:function(e,n,t){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=t+e.index+e[0].length,e.startIndex=t+e.index,e.index=n,e},getAggregateText:function(){var o=this.options.filterElements,a=this.options.forceContext;return function e(n,t){if(3===n.nodeType)return[n.data];if(o&&!o(n))return[];t=[""];var i=0;if(n=n.firstChild)do{if(3!==n.nodeType){var r=e(n);a&&1===n.nodeType&&(!0===a||a(n))?(t[++i]=r,t[++i]=""):("string"==typeof r[0]&&(t[i]+=r.shift()),r.length&&(t[++i]=r,t[++i]=""))}else t[i]+=n.data}while(n=n.nextSibling);return t}(this.node)},processMatches:function(){var e,n,t,i=this.matches,r=this.node,o=this.options.filterElements,a=[],c=r,s=i.shift(),d=0,u=0,l=[r];e:for(;;){if(3===c.nodeType&&(!n&&c.length+d>=s.endIndex?n={node:c,index:u++,text:c.data.substring(s.startIndex-d,s.endIndex-d),indexInMatch:d-s.startIndex,indexInNode:s.startIndex-d,endIndexInNode:s.endIndex-d,isEnd:!0}:e&&a.push({node:c,index:u++,text:c.data,indexInMatch:d-s.startIndex,indexInNode:0}),!e&&c.length+d>s.startIndex&&(e={node:c,index:u++,indexInMatch:0,indexInNode:s.startIndex-d,endIndexInNode:s.endIndex-d,text:c.data.substring(s.startIndex-d,s.endIndex-d)}),d+=c.data.length),t=1===c.nodeType&&o&&!o(c),e&&n){if(c=this.replaceMatch(s,e,a,n),d-=n.node.data.length-n.endIndexInNode,n=e=null,a=[],u=0,!(s=i.shift()))break}else if(!t&&(c.firstChild||c.nextSibling)){c=c.firstChild?(l.push(c),c.firstChild):c.nextSibling;continue}for(;;){if(c.nextSibling){c=c.nextSibling;break}if((c=l.pop())===r)break e}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,n,i,t){var r=this.options.portionMode;return"first"===r&&0<n.indexInMatch?"":(e=e.replace(/\$(\d+|&|`|')/g,function(e,n){var t;switch(n){case"&":t=i[0];break;case"`":t=i.input.substring(0,i.startIndex);break;case"'":t=i.input.substring(i.endIndex);break;default:t=i[+n]}return t}),"first"===r?e:n.isEnd?e.substring(n.indexInMatch):e.substring(n.indexInMatch,n.indexInMatch+n.text.length))},getPortionReplacementNode:function(e,n,t){var i=this.options.replace||"$&",r=this.options.wrap;if(r&&r.nodeType){var o=y.createElement("div");o.innerHTML=r.outerHTML||(new XMLSerializer).serializeToString(r),r=o.firstChild}if("function"==typeof i)return(i=i(e,n,t))&&i.nodeType?i:y.createTextNode(String(i));var a="string"==typeof r?y.createElement(r):r;return(i=y.createTextNode(this.prepareReplacementString(i,e,n,t))).data&&a?(a.appendChild(i),a):i},replaceMatch:function(e,n,t,i){var r,o,a=n.node,c=i.node;if(a===c){var s=a;0<n.indexInNode&&(r=y.createTextNode(s.data.substring(0,n.indexInNode)),s.parentNode.insertBefore(r,s));var d=this.getPortionReplacementNode(i,e);return s.parentNode.insertBefore(d,s),i.endIndexInNode<s.length&&(o=y.createTextNode(s.data.substring(i.endIndexInNode)),s.parentNode.insertBefore(o,s)),s.parentNode.removeChild(s),this.reverts.push(function(){r===d.previousSibling&&r.parentNode.removeChild(r),o===d.nextSibling&&o.parentNode.removeChild(o),d.parentNode.replaceChild(s,d)}),d}r=y.createTextNode(a.data.substring(0,n.indexInNode)),o=y.createTextNode(c.data.substring(i.endIndexInNode));for(var u=this.getPortionReplacementNode(n,e),l=[],h=0,p=t.length;h<p;++h){var f=t[h],b=this.getPortionReplacementNode(f,e);f.node.parentNode.replaceChild(b,f.node),this.reverts.push(function(e,n){return function(){n.parentNode.replaceChild(e.node,n)}}(f,b)),l.push(b)}var g=this.getPortionReplacementNode(i,e);return a.parentNode.insertBefore(r,a),a.parentNode.insertBefore(u,a),a.parentNode.removeChild(a),c.parentNode.insertBefore(g,c),c.parentNode.insertBefore(o,c),c.parentNode.removeChild(c),this.reverts.push(function(){r.parentNode.removeChild(r),u.parentNode.replaceChild(a,u),o.parentNode.removeChild(o),g.parentNode.replaceChild(c,g)}),g}},s}()),F=((_=B.create("div")).appendChild(B.create("","0-")),_.appendChild(B.create("","2")),_.normalize(),2!==_.firstChild.length);function q(e){return"function"==typeof e||e instanceof Element?e:void 0}function U(e){var n=0===e.index&&e.isEnd?"biaodian cjk":"biaodian cjk portion "+(0===e.index?"is-first":e.isEnd?"is-end":"is-inner"),t=B.create("h-char-group",n);return t.innerHTML=e.text,t}function Y(e){var n,t=B.create("div"),i=e.charCodeAt(0).toString(16);return t.innerHTML='<h-char unicode="'+i+'" class="biaodian cjk '+((n=e).match(O.char.biaodian.open)?"bd-open":n.match(O.char.biaodian.close)?"bd-close bd-end":n.match(O.char.biaodian.end)?/(?:\u3001|\u3002|\uff0c)/i.test(n)?"bd-end bd-cop":"bd-end":n.match(new RegExp(P.biaodian.liga))?"bd-liga":n.match(new RegExp(P.biaodian.middle))?"bd-middle":"")+'">'+e+"</h-char>",t.firstChild}B.extend(D.fn,{normalize:function(){return F&&this.context.normalize(),this},jinzify:function(e){return this.filter(e||null).avoid("h-jinze").replace(O.jinze.touwei,function(e,n){var t=B.create("h-jinze","touwei");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""}).replace(O.jinze.wei,function(e,n){var t=B.create("h-jinze","wei");return t.innerHTML=n[0],0===e.index?t:""}).replace(O.jinze.tou,function(e,n){var t=B.create("h-jinze","tou");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""}).replace(O.jinze.middle,function(e,n){var t=B.create("h-jinze","middle");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""}).endAvoid().endFilter()},groupify:function(e){return e=B.extend({biaodian:!1,hanzi:!1,kana:!1,eonmun:!1,western:!1},e||{}),this.avoid("h-word, h-char-group"),e.biaodian&&this.replace(O.group.biaodian[0],U).replace(O.group.biaodian[1],U),(e.hanzi||e.cjk)&&this.wrap(O.group.hanzi,B.clone(B.create("h-char-group","hanzi cjk"))),e.western&&this.wrap(O.group.western,B.clone(B.create("h-word","western"))),e.kana&&this.wrap(O.group.kana,B.clone(B.create("h-char-group","kana"))),(e.eonmun||e.hangul)&&this.wrap(O.group.eonmun,B.clone(B.create("h-word","eonmun hangul"))),this.endAvoid(),this},charify:function(e){return(e=B.extend({avoid:!0,biaodian:!1,punct:!1,hanzi:!1,latin:!1,ellinika:!1,kirillica:!1,kana:!1,eonmun:!1},e||{})).avoid&&this.avoid("h-char"),e.biaodian&&this.replace(O.char.biaodian.all,q(e.biaodian)||function(e){return Y(e.text)}).replace(O.char.biaodian.liga,q(e.biaodian)||function(e){return Y(e.text)}),(e.hanzi||e.cjk)&&this.wrap(O.char.hanzi,q(e.hanzi||e.cjk)||B.clone(B.create("h-char","hanzi cjk"))),e.punct&&this.wrap(O.char.punct.all,q(e.punct)||B.clone(B.create("h-char","punct"))),e.latin&&this.wrap(O.char.latin,q(e.latin)||B.clone(B.create("h-char","alphabet latin"))),(e.ellinika||e.greek)&&this.wrap(O.char.ellinika,q(e.ellinika||e.greek)||B.clone(B.create("h-char","alphabet ellinika greek"))),(e.kirillica||e.cyrillic)&&this.wrap(O.char.kirillica,q(e.kirillica||e.cyrillic)||B.clone(B.create("h-char","alphabet kirillica cyrillic"))),e.kana&&this.wrap(O.char.kana,q(e.kana)||B.clone(B.create("h-char","kana"))),(e.eonmun||e.hangul)&&this.wrap(O.char.eonmun,q(e.eonmun||e.hangul)||B.clone(B.create("h-char","eonmun hangul"))),this.endAvoid(),this}}),B.extend(s,{isNodeNormalizeNormal:F,find:D,createBDGroup:U,createBDChar:Y}),B.matches=s.find.matches,["setMode","wrap","replace","revert","addBoundary","removeBoundary","avoid","endAvoid","filter","endFilter","jinzify","groupify","charify"].forEach(function(e){s.fn[e]=function(){return this.finder||(this.finder=s.find(this.context)),this.finder[e](arguments[0],arguments[1]),this}});var W={};function V(e,n){var t,i=B.create("canvas");return i.width="50",i.height="20",i.style.display="none",m.appendChild(i),(t=i.getContext("2d")).textBaseline="top",t.font="15px "+n+", sans-serif",t.fillStyle="black",t.strokeStyle="black",t.fillText(e,0,0),{node:i,context:t,remove:function(){B.remove(i,m)}}}function Z(e,n){var t,i=e.context,r=n.context;try{for(var o=1;o<=20;o++)for(var a=1;a<=50;a++){if(void 0===t&&i.getImageData(a,o,1,1).data[3]!==r.getImageData(a,o,1,1).data[3]){t=!1;break}if("boolean"==typeof t)break;50===a&&20===o&&void 0===t&&(t=!0)}return e.remove(),n.remove(),n=e=null,t}catch(e){}return!1}W.writeOnCanvas=V,W.compareCanvases=Z,W.detectFont=function(e,n,t){return e=e,n=V(t=t||"辭Q",n=n||"sans-serif"),!Z(e=V(t,e),n)},W.support=function(){var e,n,t,i,r,o,a,c,s,d,u="Webkit Moz ms".split(" "),l=B.create("h-test");function h(e){var n,t=e.charAt(0).toUpperCase()+e.slice(1);return(e+" "+u.join(t+" ")+t).split(" ").forEach(function(e){"string"==typeof l.style[e]&&(n=!0)}),n||!1}function p(e,n){var t,i,r,o=m||B.create("body"),a=B.create("div"),c=m?a:o;return n="function"==typeof n?n:function(){},t=["<style>",e,"</style>"].join(""),c.innerHTML+=t,o.appendChild(a),m||(o.style.background="",o.style.overflow="hidden",r=y.style.overflow,y.style.overflow="hidden",y.appendChild(o)),i=n(c,e),B.remove(c),m||(y.style.overflow=r),!!i}function f(e,n){var t;return b.getComputedStyle?t=g.defaultView.getComputedStyle(e,null).getPropertyValue(n):e.currentStyle&&(t=e.currentStyle[n]),t}return{columnwidth:h("columnWidth"),fontface:(p('@font-face { font-family: font; src: url("//"); }',function(e,n){var t=B.qsa("style",e)[0],i=t.sheet||t.styleSheet,r=i?i.cssRules&&i.cssRules[0]?i.cssRules[0].cssText:i.cssText||"":"";d=/src/i.test(r)&&0===r.indexOf(n.split(" ")[0])}),d),ruby:(a=B.create("ruby"),c=B.create("rt"),s=B.create("rp"),a.appendChild(s),a.appendChild(c),y.appendChild(a),o="none"===f(s,"display")||"ruby"===f(a,"display")&&"ruby-text"===f(c,"display"),y.removeChild(a),s=c=a=null,o),"ruby-display":(r=B.create("div"),r.innerHTML='<h-test-a style="display: ruby;"></h-test-a><h-test-b style="display: ruby-text-container;"></h-test-b>',"ruby"===r.querySelector("h-test-a").style.display&&"ruby-text-container"===r.querySelector("h-test-b").style.display),"ruby-interchar":(t="inter-character",i=B.create("div"),i.innerHTML='<h-test style="-moz-ruby-position:'+t+";-ms-ruby-position:"+t+";-webkit-ruby-position:"+t+";ruby-position:"+t+';"></h-test>',(n=i.querySelector("h-test").style).rubyPosition===t||n.WebkitRubyPosition===t||n.MozRubyPosition===t||n.msRubyPosition===t),textemphasis:h("textEmphasis"),unicoderange:(p('@font-face{font-family:test-for-unicode-range;src:local(Arial),local("Droid Sans")}@font-face{font-family:test-for-unicode-range;src:local("Times New Roman"),local(Times),local("Droid Serif");unicode-range:U+270C}',function(){e=!W.detectFont("test-for-unicode-range",'Arial, "Droid Sans"',"Q")}),e),writingmode:h("writingMode")}}(),W.initCond=function(e){e=e||y;var n,t="";for(var i in W.support)n=(W.support[i]?"":"no-")+i,e.classList.add(n),t+=n+" ";return t};var $=W.support["ruby-interchar"];function J(e){var r,n=B.create("!"),o=e.classList;return n.appendChild(B.clone(e)),B.tag("rt",n.firstChild).forEach(function(e){var n,t=B.create("!"),i=[];do{if(!(n=(n||e).previousSibling)||n.nodeName.match(/((?:h\-)?r[ubt])/i))break;t.insertBefore(B.clone(n),t.firstChild),i.push(n)}while(!n.nodeName.match(/((?:h\-)?r[ubt])/i));r=o.contains("zhuyin")?ne(t,e):ee(t,e);try{e.parentNode.replaceChild(r,e),i.map(B.remove)}catch(e){}}),Q(n)}function G(e){var n=B.create("!");return n.appendChild(B.clone(e)),B.tag("rt",n.firstChild).forEach(function(e){var n,t,i=B.create("!"),r=[];do{if(!(n=(n||e).previousSibling)||n.nodeName.match(/((?:h\-)?r[ubt])/i))break;i.insertBefore(B.clone(n),i.firstChild),r.push(n)}while(!n.nodeName.match(/((?:h\-)?r[ubt])/i));(t=B.create("rt")).innerHTML=te(e),e.parentNode.replaceChild(t,e)}),n.firstChild}function K(e){var n,i,s,d,t,r=B.create("!"),u=e.classList;return r.appendChild(B.clone(e)),n=r.firstChild,i=s=B.tag("rb",n),d=i.length,(t=n.querySelector("rtc.zhuyin"))&&(s=B.tag("rt",t).map(function(e,n){if(i[n]){var t=ne(i[n],e);try{i[n].parentNode.replaceChild(t,i[n])}catch(e){}return t}}),B.remove(t),n.setAttribute("rightangle","true")),B.qsa("rtc:not(.zhuyin)",n).forEach(function(e,c){s=B.tag("rt",e).map(function(e,n){var t,i,r=Number(e.getAttribute("rbspan")||1),o=0,a=[];d<r&&(r=d);do{try{t=s.shift(),a.push(t)}catch(e){}if(void 0===t)break;o+=Number(t.getAttribute("span")||1)}while(o<r);if(r<o){if(1<a.length)return void console.error("An impossible `rbspan` value detected.",ruby);a=B.tag("rb",a[0]),s=a.slice(r).concat(s),a=a.slice(0,r),o=r}i=ee(a,e,{class:u,span:o,order:c});try{a[0].parentNode.replaceChild(i,a.shift()),a.map(B.remove)}catch(e){}return i}),1===c&&n.setAttribute("doubleline","true"),B.remove(e)}),Q(r)}function Q(e){var n=e.firstChild,t=B.create("h-ruby");return t.innerHTML=n.innerHTML,B.setAttr(t,n.attributes),t.normalize(),t}function X(e){if(!e instanceof Element)return e;var n=e.classList;return n.contains("pinyin")?n.add("romanization"):n.contains("romanization")?n.add("annotation"):n.contains("mps")?n.add("zhuyin"):n.contains("rightangle")&&n.add("complex"),e}function ee(e,n,t){var i=B.create("h-ru");return n=B.clone(n),(t=t||{}).annotation="true",Array.isArray(e)?i.innerHTML=e.map(function(e){return void 0===e?"":e.outerHTML}).join("")+n.outerHTML:(i.appendChild(B.clone(e)),i.appendChild(n)),B.setAttr(i,t),i}function ne(e,n){e=B.clone(e);var t=B.create("h-ru");return t.setAttribute("zhuyin",!0),t.appendChild(e),t.innerHTML+=te(n),t}function te(e){var n,t,i,r="string"==typeof e?e:e.textContent;return i=(n=r.replace(O.zhuyin.diao,""))?n.length:0,t=r.replace(n,"").replace(/[\u02C5]/g,"ˇ").replace(/[\u030D]/g,"͘"),0===i?"":'<h-zhuyin length="'+i+'" diao="'+t+'"><h-yin>'+n+"</h-yin><h-diao>"+t+"</h-diao></h-zhuyin>"}B.extend(W,{renderRuby:function(e,n){n=n||"ruby";var t=B.qsa(n,e);B.qsa("rtc",e).concat(t).map(X),t.forEach(function(e){var n,t=e.classList;t.contains("complex")?n=K(e):t.contains("zhuyin")&&(n=$?G(e):J(e)),n&&e.parentNode.replaceChild(n,e)})},simplifyRubyClass:X,getZhuyinHTML:te,renderComplexRuby:K,renderSimpleRuby:J,renderInterCharRuby:G}),B.extend(W,{renderElem:function(e){this.renderRuby(e),this.renderDecoLine(e),this.renderDecoLine(e,"s, del"),this.renderEm(e)},renderDecoLine:function(e,n){var t=B.qsa(n||"u, ins",e),i=t.length;e:for(;i--;){var r=t[i],o=null;do{if(!(o=(o||r).previousSibling))continue e;t[i-1]===o&&r.classList.add("adjacent")}while(B.isIgnorable(o))}},renderEm:function(e,n){var t=n?"qsa":"tag";n=n||"em",B[t](n,e).forEach(function(e){var n=s(e);W.support.textemphasis?n.avoid("rt, h-char").charify({biaodian:!0,punct:!0}):n.avoid("rt, h-char, h-char-group").jinzify().groupify({western:!0}).charify({hanzi:!0,biaodian:!0,punct:!0,latin:!0,ellinika:!0,kirillica:!0})})}}),s.normalize=W,s.localize=W,s.support=W.support,s.detectFont=W.detectFont,s.fn.initCond=function(){return this.condition.classList.add("han-js-rendered"),s.normalize.initCond(this.condition),this},["Elem","DecoLine","Em","Ruby"].forEach(function(e){var n="render"+e;s.fn[n]=function(e){return s.normalize[n](this.context,e),this}}),B.extend(s.support,{heiti:!0,songti:s.detectFont('"Han Songti"'),"songti-gb":s.detectFont('"Han Songti GB"'),kaiti:s.detectFont('"Han Kaiti"'),fangsong:s.detectFont('"Han Fangsong"')}),s.correctBiaodian=function(e){e=e||g;var n=s.find(e);return n.avoid("h-char").replace(/([‘“])/g,function(e){var n=s.createBDChar(e.text);return n.classList.add("bd-open","punct"),n}).replace(/([’”])/g,function(e){var n=s.createBDChar(e.text);return n.classList.add("bd-close","bd-end","punct"),n}),s.support.unicoderange?n:n.charify({biaodian:!0})},s.correctBasicBD=s.correctBiaodian,s.correctBD=s.correctBiaodian,B.extend(s.fn,{biaodian:null,correctBiaodian:function(){return this.biaodian=s.correctBiaodian(this.context),this},revertCorrectedBiaodian:function(){try{this.biaodian.revert("all")}catch(e){}return this}}),s.fn.correctBasicBD=s.fn.correctBiaodian,s.fn.revertBasicBD=s.fn.revertCorrectedBiaodian;var ie,re="<<hws>>",oe=B.create("h-hws");function ae(e,n){return e.isEnd&&0===e.index?n[1]+re+n[2]:0===e.index?function(e,n){var t,i,r=e;if(n=n||"",B.isElmt(e.nextSibling)||(i=(t=e).nextSibling,t&&i&&t.parentNode===i.parentNode))return n+re;for(;!r.nextSibling;)r=r.parentNode;return e!==r&&r.insertAdjacentHTML("afterEnd","<h-hws hidden> </h-hws>"),n}(e.node,e.text):e.text}function ce(e){return 0===e.index?B.clone(oe):""}function se(e){var n=e.node.parentNode;return 0===e.index&&(ie=e.endIndexInNode-2),"h-hws"!==n.nodeName.toLowerCase()||1!==e.index&&e.indexInMatch!==ie||n.classList.add("quote-inner"),e.text}function de(e){var n=e.node.parentNode;return"h-hws"===n.nodeName.toLowerCase()&&n.classList.add("quote-outer"),e.text}oe.setAttribute("hidden",""),oe.innerHTML=" ",B.extend(s,{renderHWS:function(e,n){var t=n?"textarea, code, kbd, samp, pre":"textarea",i=n?"strict":"base",r=(e=e||g,s.find(e));return r.avoid(t).replace(s.TYPESET.hws[i][0],ae).replace(s.TYPESET.hws[i][1],ae).replace(new RegExp("("+re+")+","g"),ce).replace(/([\'"])\s(.+?)\s\1/g,se).replace(/\s[‘“]/g,de).replace(/[’”]\s/g,de).normalize(),r}}),B.extend(s.fn,{renderHWS:function(e){return s.renderHWS(this.context,e),this},revertHWS:function(){return B.tag("h-hws",this.context).forEach(function(e){B.remove(e)}),this.HWS=[],this}});var ue="bd-hangable",le=s.find.matches;function he(){var e,n=B.create("div");return n.innerHTML="<span>a b</span><span style=\"font-family: 'Han Space'\">a b</span>",m.appendChild(n),e=n.firstChild.offsetWidth!==n.lastChild.offsetWidth,B.remove(n),e}s.support["han-space"]=he(),B.extend(s,{detectSpaceFont:he,isSpaceFontLoaded:he(),renderHanging:function(e){e=e||g;var n=s.find(e);return n.avoid("textarea, code, kbd, samp, pre").avoid("h-char.bd-hangable").replace(O.jinze.hanging,function(e){if(/^[\x20\t\r\n\f]+$/.test(e.text))return"";var n,t,i,r,o,a,c=e.node.parentNode;return(n=B.parent(c,"h-jinze"))&&((a=(o=n).nextSibling)&&le(a,"h-cs.jinze-outer")?a.classList.add("hangable-outer"):o.insertAdjacentHTML("afterend",'<h-cs hidden class="jinze-outer hangable-outer"> </h-cs>')),r=e.text.trim(),(t=s.createBDChar(r)).innerHTML="<h-inner>"+r+"</h-inner>",t.classList.add(ue),(i=B.parent(c,"h-char.biaodian"))?(i.classList.add(ue),le(c,"h-inner, h-inner *")?r:t.firstChild):t}),n}}),B.extend(s.fn,{renderHanging:function(){var e=this.condition.classList;return s.isSpaceFontLoaded=he(),s.isSpaceFontLoaded&&e.contains("no-han-space")&&(e.remove("no-han-space"),e.add("han-space")),s.renderHanging(this.context),this},revertHanging:function(){return B.qsa("h-char.bd-hangable, h-cs.hangable-outer",this.context).forEach(function(e){var n=e.classList;n.remove("bd-hangable"),n.remove("hangable-outer")}),this}});var pe,fe,be="bd-jiya",ge="bd-consecutive",ye='<h-cs hidden class="jinze-outer jiya-outer"> </h-cs>';function me(e){return e.replace(/(biaodian|cjk|bd-jiya|bd-consecutive|bd-hangable)/gi,"").trim()}function ve(e){var n,t,i=e.text,r=e.node.parentNode,o=B.parent(r,"h-char.biaodian"),a=s.createBDChar(i);return a.innerHTML="<h-inner>"+i+"</h-inner>",a.classList.add(be),(n=B.parent(r,"h-jinze"))&&(le(t=n,".tou, .touwei")&&!le(t.previousSibling,"h-cs.jiya-outer")&&t.insertAdjacentHTML("beforebegin",ye),le(t,".wei, .touwei")&&!le(t.nextSibling,"h-cs.jiya-outer")&&t.insertAdjacentHTML("afterend",ye)),o?(o.classList.add(be),le(r,"h-inner, h-inner *")?i:a.firstChild):a}function xe(e){var n,t,i,r,o,a=pe,c=e.node.parentNode,s=B.parent(c,"h-char.biaodian"),d=B.parent(s,"h-jinze");return n=s.classList,a&&s.setAttribute("prev",a),fe&&n.contains("bd-open")&&fe.pop().setAttribute("next","bd-open"),fe=void 0,e.isEnd?(pe=void 0,n.add(ge,"end-portion")):(pe=me(s.getAttribute("class")),n.add(ge)),d&&(t=d,i={prev:a,class:me(s.getAttribute("class"))},le(t,".tou, .touwei")&&(r=t.previousSibling,le(r,"h-cs")&&(r.className="jinze-outer jiya-outer",r.setAttribute("prev",i.prev))),le(t,".wei, .touwei")&&(o=t.nextSibling,le(o,"h-cs")&&(o.className="jinze-outer jiya-outer "+i.class,o.removeAttribute("prev"))),fe=[r,o]),e.text}le=s.find.matches,s.renderJiya=function(e){e=e||g;var n=s.find(e);return n.avoid("textarea, code, kbd, samp, pre, h-cs").avoid("h-char.bd-jiya").charify({avoid:!1,biaodian:ve}).endAvoid().avoid("textarea, code, kbd, samp, pre, h-cs").replace(O.group.biaodian[0],xe).replace(O.group.biaodian[1],xe),n},B.extend(s.fn,{renderJiya:function(){return s.renderJiya(this.context),this},revertJiya:function(){return B.qsa("h-char.bd-jiya, h-cs.jiya-outer",this.context).forEach(function(e){var n=e.classList;n.remove("bd-jiya"),n.remove("jiya-outer")}),this}});var Ee="textarea, code, kbd, samp, pre";function we(t,i,r){return function(){var e=s.localize.writeOnCanvas(i,t),n=s.localize.writeOnCanvas(r,t);return s.localize.compareCanvases(e,n)}}function Ce(){return we('"Romanization Sans"',"i̍","󰁩")}function Ne(t){return function(e){e=e||g;var n=s.find(e).avoid(Ee);return t.forEach(function(i){n.replace(new RegExp(i[0],"ig"),function(e,n){var t=B.clone(Se);return t.innerHTML="<h-inner>"+n[0]+"</h-inner>",t.setAttribute("display-as",i[1]),0===e.index?t:""})}),n}}var Se=B.create("h-char","comb-liga");return B.extend(s,{isVowelCombLigaNormal:we('"Romanization Sans"',"a̍","󰁡"),isVowelICombLigaNormal:Ce(),isZhuyinCombLigaNormal:we('"Zhuyin Kaiti"',"ㆴ͘","󳆴"),isCombLigaNormal:Ce()(),substVowelCombLiga:Ne(s.TYPESET["display-as"]["comb-liga-vowel"]),substZhuyinCombLiga:Ne(s.TYPESET["display-as"]["comb-liga-zhuyin"]),substCombLigaWithPUA:Ne(s.TYPESET["display-as"]["comb-liga-pua"]),substInaccurateChar:function(e){e=e||g;var n=s.find(e);n.avoid(Ee),s.TYPESET["inaccurate-char"].forEach(function(e){n.replace(new RegExp(e[0],"ig"),e[1])})}}),B.extend(s.fn,{"comb-liga-vowel":null,"comb-liga-vowel-i":null,"comb-liga-zhuyin":null,"inaccurate-char":null,substVowelCombLiga:function(){return this["comb-liga-vowel"]=s.substVowelCombLiga(this.context),this},substVowelICombLiga:function(){return this["comb-liga-vowel-i"]=s.substVowelICombLiga(this.context),this},substZhuyinCombLiga:function(){return this["comb-liga-zhuyin"]=s.substZhuyinCombLiga(this.context),this},substCombLigaWithPUA:function(){return s.isVowelCombLigaNormal()?s.isVowelICombLigaNormal()||(this["comb-liga-vowel-i"]=s.substVowelICombLiga(this.context)):this["comb-liga-vowel"]=s.substVowelCombLiga(this.context),s.isZhuyinCombLigaNormal()||(this["comb-liga-zhuyin"]=s.substZhuyinCombLiga(this.context)),this},revertVowelCombLiga:function(){try{this["comb-liga-vowel"].revert("all")}catch(e){}return this},revertVowelICombLiga:function(){try{this["comb-liga-vowel-i"].revert("all")}catch(e){}return this},revertZhuyinCombLiga:function(){try{this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},revertCombLigaWithPUA:function(){try{this["comb-liga-vowel"].revert("all"),this["comb-liga-vowel-i"].revert("all"),this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},substInaccurateChar:function(){return this["inaccurate-char"]=s.substInaccurateChar(this.context),this},revertInaccurateChar:function(){try{this["inaccurate-char"].revert("all")}catch(e){}return this}}),b.addEventListener("DOMContentLoaded",function(){var e;y.classList.contains("han-init")?s.init():(e=g.querySelector(".han-init-context"))&&(s.init=s(e).render())}),void 0!==e&&!1!==e||(b.Han=s),s});